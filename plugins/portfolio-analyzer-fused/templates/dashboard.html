<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #0f0f23;
            color: #e0e0e0;
            padding: 20px;
        }
        .container { max-width: 1400px; margin: 0 auto; }
        h1 { color: #00d9ff; font-size: 2em; margin-bottom: 10px; }
        .timestamp { color: #888; font-size: 0.9em; margin-bottom: 30px; }

        .summary-card {
            background: #1a1a2e;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid #333;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .metric { text-align: center; }
        .metric-label { color: #888; font-size: 0.9em; margin-bottom: 5px; }
        .metric-value { font-size: 1.8em; font-weight: bold; }
        .metric-value.positive { color: #00ff88; }
        .metric-value.negative { color: #ff4444; }

        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: #1a1a2e;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #333;
        }

        .chart-card h2 {
            color: #00d9ff;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: #1a1a2e;
            border-radius: 10px;
            overflow: hidden;
        }

        th {
            background: #252540;
            color: #00d9ff;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 12px;
            border-top: 1px solid #333;
        }

        tr:hover { background: #252540; }

        .grade-A { color: #00ff88; font-weight: bold; }
        .grade-B { color: #00d9ff; font-weight: bold; }
        .grade-C { color: #ffaa00; font-weight: bold; }
        .grade-D { color: #ff4444; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ“Š Portfolio Dashboard</h1>
        <div class="timestamp">Generated: {{timestamp}}</div>

        <div class="summary-card">
            <div class="summary-grid">
                <div class="metric">
                    <div class="metric-label">Total Value</div>
                    <div class="metric-value">{{total_value}}</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Total P&L</div>
                    <div class="metric-value {{pl_class}}">{{total_pl}}</div>
                </div>
                <div class="metric">
                    <div class="metric-label">P&L %</div>
                    <div class="metric-value {{pl_class}}">{{total_pl_pct}}</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Weighted Score</div>
                    <div class="metric-value">{{weighted_score}}</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Holdings</div>
                    <div class="metric-value">{{holdings_count}}</div>
                </div>
            </div>
        </div>

        <div class="chart-grid">
            <div class="chart-card">
                <h2>Sector Allocation</h2>
                <canvas id="sectorChart"></canvas>
            </div>
            <div class="chart-card">
                <h2>Score Distribution</h2>
                <canvas id="scoreChart"></canvas>
            </div>
            <div class="chart-card">
                <h2>Top Holdings by Value</h2>
                <canvas id="holdingsChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <h2>Portfolio Holdings</h2>
            <table>
                <thead>
                    <tr>
                        <th>Ticker</th>
                        <th>Sector</th>
                        <th>Shares</th>
                        <th>Avg Price</th>
                        <th>Current</th>
                        <th>Value</th>
                        <th>Weight</th>
                        <th>P&L %</th>
                        <th>Score</th>
                        <th>Grade</th>
                    </tr>
                </thead>
                <tbody>
                    {{holdings_rows}}
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Sector Allocation Chart
        new Chart(document.getElementById('sectorChart'), {
            type: 'pie',
            data: {
                labels: {{sector_labels}},
                datasets: [{
                    data: {{sector_values}},
                    backgroundColor: ['#00d9ff', '#00ff88', '#ffaa00', '#ff4444', '#aa00ff', '#ff00aa', '#88ff00']
                }]
            },
            options: {
                plugins: { legend: { labels: { color: '#e0e0e0' } } }
            }
        });

        // Score Distribution Chart
        new Chart(document.getElementById('scoreChart'), {
            type: 'bar',
            data: {
                labels: ['A+', 'A', 'B+', 'B', 'C', 'D'],
                datasets: [{
                    label: 'Number of Stocks',
                    data: {{score_distribution}},
                    backgroundColor: '#00d9ff'
                }]
            },
            options: {
                scales: {
                    y: { ticks: { color: '#e0e0e0' }, grid: { color: '#333' } },
                    x: { ticks: { color: '#e0e0e0' }, grid: { color: '#333' } }
                },
                plugins: { legend: { labels: { color: '#e0e0e0' } } }
            }
        });

        // Top Holdings Chart
        new Chart(document.getElementById('holdingsChart'), {
            type: 'bar',
            data: {
                labels: {{top_holdings_labels}},
                datasets: [{
                    label: 'Value ($)',
                    data: {{top_holdings_values}},
                    backgroundColor: '#00ff88'
                }]
            },
            options: {
                indexAxis: 'y',
                scales: {
                    x: { ticks: { color: '#e0e0e0' }, grid: { color: '#333' } },
                    y: { ticks: { color: '#e0e0e0' }, grid: { color: '#333' } }
                },
                plugins: { legend: { labels: { color: '#e0e0e0' } } }
            }
        });
    </script>
</body>
</html>
